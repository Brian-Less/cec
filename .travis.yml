language: cpp
dist: xenial
os: linux
compiler:
  - gcc
addons:
  apt:
    packages:
      - g++-multilib

before_script:
  - mkdir build && cd build
  - cmake .. -DCMAKE_BUILD_TYPE=Release

script:
  - make
  - cd ..

after_success:
  - wget https://raw.githubusercontent.com/DiscordHooks/travis-ci-discord-webhook/master/send.sh
  - chmod +x send.sh
  - ./send.sh success $WEBHOOK_URL
  
after_failure:
  - wget https://raw.githubusercontent.com/DiscordHooks/travis-ci-discord-webhook/master/send.sh
  - chmod +x send.sh
  - ./send.sh failure $WEBHOOK_URL


deploy:
  provider: releases
  api_key:
    secure: hMqRZyxtoeT9PYW2DuMesZ4wWfr0bGa/+HN3t+eKNNgpa6ZSyvKt5NVrINKOWsv79iPhDzBb5ZYhwMpLd1E1QCPq5zxnFYWSD6+5EvRlyfx1S3XX8Vs/Wrav0LRJpNUorOXkx1Q+b1dsvyRbQe8WmWraamnj0BlCwFohdWJNsQy3Iz1diV1Q6+AioBpZn0EOBNJwcHQI2M8j/JtJuTAWHwKK83gRJEs1fWW8SArc0Pd/umDHWL+L60MYrPp/RXWvwbTd4kXeZ1KzWAZPeYzb1KK7/N/fzD6arfajYNuoC/M4IZ+QHge6CfLG2jWQ/aod9Vo4349PPjAtQZ0i7BSKiVPAc6g6xXnBoYGNPiULDqAg6vznYUZgPU97Pz1yw8dKWTiIwIcaSM+brq0uKiUKBbiCQmIwADfTdvVtOaAb5UdSl10f6Zag55FcvZpCJK1RRANnD2qo5V5dry4s4hFNt1anzoa7vwHLkocgzxAUtbKvmLPn6PXGilA7JQAvusgnXIETzP6YFxspNKKz+In52jo0eVKn9bFFkMe0m1VnQLsb2F3O7zH/qpsoDAQ17FOyVFUIB9+gpId2y8R8fNQhrlvmUA8grj92p9MQN+3tst2P/fEWL3PWMrjsQ+mA+EznW57cm0IJ5OhspkMJFhvb2AfJBzOyss+2Nr2J8DGT+uE=
  file: "test/plugins/cec.so"
  skip_cleanup: true
  on:
    tags: true
