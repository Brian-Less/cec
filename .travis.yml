language: cpp
dist: xenial
os: linux
compiler:
  - gcc
addons:
  apt:
    packages:
      - g++-multilib

before_script:
  - mkdir build && cd build
  - cmake .. -DCMAKE_BUILD_TYPE=Release

script:
  - make
  - cd ..

after_success:
  - wget https://raw.githubusercontent.com/DiscordHooks/travis-ci-discord-webhook/master/send.sh
  - chmod +x send.sh
  - ./send.sh success $WEBHOOK_URL
  
after_failure:
  - wget https://raw.githubusercontent.com/DiscordHooks/travis-ci-discord-webhook/master/send.sh
  - chmod +x send.sh
  - ./send.sh failure $WEBHOOK_URL


deploy:
  provider: releases
  api_key:
    secure: UQA2ilhC00lKa0MZFyytq1YmKibd3tr1i2EXYTHUIvJKmUAOagkUX3mWMYOEKt0KLDGPzoK5UdgERX8pFHsmpy1AlU2x6Mw59oRS+IBbWA/PF8Pu4uFzFxnt5+vUKiZo8ZOK1NCtxWePbGy7HsIVRqaCbbI5fWrtqmo/YX5lr/gR4TymZ5lo1D/ai02fYNVZAZe5TXL1Bwr7ANONN/smH9mCoEZJ1HwWtKPLdSZxuJEHb5YonN9GD/06GDCMv0b4GY27lGYg2SdYbJXWnXmIZ6/jQtTuaTd0BUlF74JXcerjTMI1ROYsv1oGmL+cr744kfs+At1czGITLncIWK9OFoVhuuDTIxm8mHl2Zy72dj5zNVHsvMybJ3wcYvYU8bHOCkMe2KoAKsxzWXrkIKTLVq/qTtKv+C9txr4zcHFuB4bIw8hFr1P5U54NOBqZqzW092HNYJSafLe1zUvKoheyJwIYQmuWRudNryvYXBbA1t9YPatlZzEQzXZZs7y8cVnyemhfBPArcvlLF+X/9eRXlDIz5T+YAkP4LyUei7tMH+t50lG3XewJNuXURjsxnqtwg83RMrsWgoKazAUkb+5rsEJEs1AU6t6jF2s9DakD7Tq/eet2xIODGiiWVbk66o1Ti7gTpWcMGmBib3EaZ6vMKzWASoOoFeq55K6kaPlHvEE=
  file: "test/plugins/cec.so"
  skip_cleanup: true
  on:
    tags: true
